{"version":3,"file":"stackview.min.js","sources":["../src/stackview.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/**\n * Javascript for needed to load the stackviewer\n * @TODO rewrite to ES6 uses old jQuery (slick uses jQuery need more time to rewrite)\n *\n * @license   http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n * @copyright 09/05/2021 Mfreak.nl | LdesignMedia.nl - Luuk Verhoeven\n * @author    Luuk Verhoeven\n **/\n\n/* eslint-disable no-alert */\ndefine(['jquery', 'mod_stackview/slick'], function($) {\n\n    'use strict';\n\n    let $slick = $('#slick-slider');\n\n    /**\n     * CopyToClipboard\n     *\n     * @param {string} containerid\n     */\n    let copyToClipboard = function(containerid) {\n\n        const el = document.createElement('textarea');\n        el.value = document.getElementById(containerid).innerHTML;\n        el.setAttribute('readonly', '');\n        el.style.position = 'absolute';\n        el.style.left = '-9999px';\n        document.body.appendChild(el);\n        el.select();\n        document.execCommand('copy');\n        document.body.removeChild(el);\n\n        alert(\"Copied to clipboard\");\n    };\n\n    let loadSlick = function() {\n\n        $.fn.extend({\n            disableSelection: function() {\n                this.each(function() {\n                    this.onselectstart = function() {\n                        return false;\n                    };\n                    this.unselectable = \"on\";\n                    $(this).css('-moz-user-select', 'none');\n                    $(this).css('-webkit-user-select', 'none');\n                });\n                return this;\n            }\n        });\n\n        $(document).ready(function() {\n\n            $slick.on('init reInit afterChange', function(event, slick, currentSlide) {\n                let i = (currentSlide ? currentSlide : 0) + 1;\n                let calc = ((i) / (slick.slideCount)) * 100;\n\n                $('#slick-counter').text(i + '/' + slick.slideCount);\n                $('#slick-progressbar').css('background-size', '100% ' + calc + '%')\n                    .attr('aria-valuenow', calc);\n            });\n\n            let slider = $slick.slick({\n                vertical: true,\n                slidesToShow: 1,\n                slidesToScroll: 1,\n                autoplay: false,\n                dots: false,\n                speed: 1,\n                arrows: false,\n                swipeToSlide: false,\n            });\n\n            slider.on('wheel click', (function(e) {\n                e.preventDefault();\n                let $el = $(this);\n\n                if (e.target.tagName === 'IMG' || e.target.tagName === 'DIV') {\n\n                    if (e.type === 'click') {\n                        $el.slick('slickNext');\n                        return;\n                    }\n\n                    if (e.originalEvent.deltaY > 0) {\n                        $el.slick('slickNext');\n                    } else {\n                        $el.slick('slickPrev');\n                    }\n                }\n            }));\n\n            $('.slick-list').before('<span class=\"previous-slide\"><i class=\"fa fa-angle-up\"></i></span>' +\n                '<span id=\"slick-counter\">1/' + $slick.slick(\"getSlick\").slideCount +\n                '</span>' + '<div id=\"slick-progressbar\"></div>' +\n                '<span class=\"next-slide\"><i class=\"fa fa-angle-down\"></i></span>');\n\n            $('body').disableSelection();\n\n            let touchCounter;\n            $('.previous-slide').on('touchstart', (function() {\n                touchCounter = setInterval(function() {\n                    $slick.slick('slickPrev');\n                }, 200);\n            })).on('touchend', (function() {\n                clearInterval(touchCounter);\n                touchCounter = null;\n            })).on(\"mousedown\", function() {\n                $slick.slick('slickPrev');\n            });\n\n            $('.next-slide').on('touchstart', (function() {\n                touchCounter = setInterval(function() {\n                    $slick.slick('slickNext');\n                }, 200);\n            })).on('touchend', (function() {\n                clearInterval(touchCounter);\n                touchCounter = null;\n            })).on(\"mousedown\", function() {\n                $slick.slick('slickNext');\n            });\n\n            // Mouse click and hold.\n            let clickTimeout = 0;\n            $('.next-slide').on('mousedown', function() {\n                clickTimeout = setInterval(function() {\n                    $slick.slick('slickNext');\n                }, 200);\n            }).on('mouseup mouseleave', function() {\n                clearTimeout(clickTimeout);\n            });\n\n            $('.previous-slide').on('mousedown', function() {\n                clickTimeout = setInterval(function() {\n                    $slick.slick('slickPrev');\n                }, 200);\n            }).on('mouseup mouseleave', function() {\n                clearTimeout(clickTimeout);\n            });\n\n            $(window).on('resize orientationchange', function() {\n                $slick.slick('resize');\n            });\n\n            $('.stackviewer-embedcode').on('click', function() {\n                copyToClipboard(\"stack-code\");\n            });\n        });\n    };\n\n    return {\n        init: function() {\n            loadSlick();\n        }\n    };\n});\n"],"names":["define","$","$slick","loadSlick","fn","extend","disableSelection","each","onselectstart","unselectable","this","css","document","ready","touchCounter","on","event","slick","currentSlide","i","calc","slideCount","text","attr","vertical","slidesToShow","slidesToScroll","autoplay","dots","speed","arrows","swipeToSlide","e","preventDefault","$el","target","tagName","type","originalEvent","deltaY","before","setInterval","clearInterval","clickTimeout","clearTimeout","window","containerid","el","createElement","value","getElementById","innerHTML","setAttribute","style","position","left","body","appendChild","select","execCommand","removeChild","alert","init"],"mappings":";;;;;;;;AAyBAA,iCAAO,CAAC,SAAU,wBAAwB,SAASC,OAI3CC,OAASD,EAAE,iBAsBXE,UAAY,WAEZF,EAAEG,GAAGC,OAAO,CACRC,iBAAkB,uBACTC,MAAK,gBACDC,cAAgB,kBACV,QAENC,aAAe,KACpBR,EAAES,MAAMC,IAAI,mBAAoB,QAChCV,EAAES,MAAMC,IAAI,sBAAuB,WAEhCD,QAIfT,EAAEW,UAAUC,OAAM,eAgDVC,aA9CJZ,OAAOa,GAAG,2BAA2B,SAASC,MAAOC,MAAOC,kBACpDC,GAAKD,cAA8B,GAAK,EACxCE,KAASD,EAAMF,MAAMI,WAAe,IAExCpB,EAAE,kBAAkBqB,KAAKH,EAAI,IAAMF,MAAMI,YACzCpB,EAAE,sBAAsBU,IAAI,kBAAmB,QAAUS,KAAO,KAC3DG,KAAK,gBAAiBH,SAGlBlB,OAAOe,MAAM,CACtBO,UAAU,EACVC,aAAc,EACdC,eAAgB,EAChBC,UAAU,EACVC,MAAM,EACNC,MAAO,EACPC,QAAQ,EACRC,cAAc,IAGXhB,GAAG,eAAgB,SAASiB,GAC/BA,EAAEC,qBACEC,IAAMjC,EAAES,SAEa,QAArBsB,EAAEG,OAAOC,SAA0C,QAArBJ,EAAEG,OAAOC,QAAmB,IAE3C,UAAXJ,EAAEK,iBACFH,IAAIjB,MAAM,aAIVe,EAAEM,cAAcC,OAAS,EACzBL,IAAIjB,MAAM,aAEViB,IAAIjB,MAAM,iBAKtBhB,EAAE,eAAeuC,OAAO,gGACYtC,OAAOe,MAAM,YAAYI,WADrC,6GAKxBpB,EAAE,QAAQK,mBAGVL,EAAE,mBAAmBc,GAAG,cAAe,WACnCD,aAAe2B,aAAY,WACvBvC,OAAOe,MAAM,eACd,QACHF,GAAG,YAAa,WAChB2B,cAAc5B,cACdA,aAAe,QACfC,GAAG,aAAa,WAChBb,OAAOe,MAAM,gBAGjBhB,EAAE,eAAec,GAAG,cAAe,WAC/BD,aAAe2B,aAAY,WACvBvC,OAAOe,MAAM,eACd,QACHF,GAAG,YAAa,WAChB2B,cAAc5B,cACdA,aAAe,QACfC,GAAG,aAAa,WAChBb,OAAOe,MAAM,oBAIb0B,aAAe,EACnB1C,EAAE,eAAec,GAAG,aAAa,WAC7B4B,aAAeF,aAAY,WACvBvC,OAAOe,MAAM,eACd,QACJF,GAAG,sBAAsB,WACxB6B,aAAaD,iBAGjB1C,EAAE,mBAAmBc,GAAG,aAAa,WACjC4B,aAAeF,aAAY,WACvBvC,OAAOe,MAAM,eACd,QACJF,GAAG,sBAAsB,WACxB6B,aAAaD,iBAGjB1C,EAAE4C,QAAQ9B,GAAG,4BAA4B,WACrCb,OAAOe,MAAM,aAGjBhB,EAAE,0BAA0Bc,GAAG,SAAS,WA5H1B,IAAS+B,YAErBC,GAFqBD,YA6HH,cA3HlBC,GAAKnC,SAASoC,cAAc,aAC/BC,MAAQrC,SAASsC,eAAeJ,aAAaK,UAChDJ,GAAGK,aAAa,WAAY,IAC5BL,GAAGM,MAAMC,SAAW,WACpBP,GAAGM,MAAME,KAAO,UAChB3C,SAAS4C,KAAKC,YAAYV,IAC1BA,GAAGW,SACH9C,SAAS+C,YAAY,QACrB/C,SAAS4C,KAAKI,YAAYb,IAE1Bc,MAAM,oCAsHH,CACHC,KAAM,WACF3D"}